\section{Vulnerabilities}
This module uses the result of the fixed-point analysis to detect vulnerabilities in the application.

\paragraph{Trigger word definition}
A definition file is provided that contains sources, sinks and sanitisers which are used to find vulnerabilities in the source code.
A simple text file with two keywords  is used for this purpose.
The keywords ``sources:'' and ``sinks:'' are used to indicate the content of the section.
Each source or sink is written on a separate line.
A sink can have a number of sanitisers attached written with as a comma separated list after an arrow (``\texttt{->}'').
Sinks, sources and sanitisers are called trigger words, and the definition file is called a trigger word file, and an example can be seen in \cref{trigger_word_file}.
\begin{lstlisting}[style=default, caption={How the trigger word file should be defined.}, label={trigger_word_file}]
  sources:
  source_1
  source_2

  sinks:
  sink_1
  sink_2 -> sanitiser_1
  sink_3 -> sanitiser_1, sanitiser_2, sanitiser_3
\end{lstlisting}

\paragraph{Finding and logging vulnerabilities}
After parsing the file all potential vulnerabilities are found and saved in a log.
The concept of finding vulnerabilities was described in \cref{theory_finding_vulns}.
Vulnerabilities are found by first identifying all nodes which contain a trigger word.
All sources are then checked if their constraint contain a source, and i that is the case, if a sanitiser is in between the two.
These cases are then logged to the vulnerability log.
A \texttt{Vulnerability} is an object which consists of a source and a sink CFG node, and which words triggered the detection of these.
A source and a sink have attached a line number to them, this line number tells where they are located in the source code.
This information is used to make it as easy as possible for the developer to find and determine whether the vulnerability found is harmful.
An example of a vulnerability log can be found in \cref{vulnerability_log_example}.
The output shown is after running \pyt{} on \cref{xss}.
The vulnerability is reported by showing details of both source and sink, with the relevant trigger word and the line number in the source code.
This should enable the developer to either fix the vulnerability or assess it as being safe.

\begin{lstlisting}[style=default, caption={An example of how the vulnerability log looks after it found one vulnerability.}, label={vulnerability_log_example}]
1 vulnerability found:
Vulnerability 0:
User input at line 8, trigger word "get": 
    param = request.args.get('param', 'not set')
reaches line 11, trigger word "replace": 
    resp = make_response(html.replace('{{ param }}', param))
\end{lstlisting}
\todo{passer den her listing stadig?}
